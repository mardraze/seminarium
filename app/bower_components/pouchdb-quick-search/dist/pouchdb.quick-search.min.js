!function e(t,n,r){function o(u,s){if(!n[u]){if(!t[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+u+"'")}var c=n[u]={exports:{}};t[u][0].call(c.exports,function(e){var n=t[u][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){function r(e,t){return e+t}function o(e,t){return t.pipeline.run(p.tokenizer(e))}function i(e,t){var n;if(e.deepField){n=t;for(var r=0,o=e.deepField.length;o>r;r++)n=n&&n[e.deepField[r]]}else n=t[e.field];return n&&(Array.isArray(n)?n=n.join(" "):"string"!=typeof n&&(n=n.toString())),n}function u(e,t,n,r){return function(u,s){if(!f(u,n,r)){for(var a=[],c=0,l=e.length;l>c;c++){var h,d=e[c],p=i(d,u);if(p){for(var v=o(p,t),y=0,m=v.length;m>y;y++){var b=v[y],k=e.length>1?c:void 0;s(g+b,k)}h=Math.sqrt(v.length)}else h=0;a.push(h)}s(w+u._id,a)}}}function s(e,t,n,o,i){var u=Object.keys(n).map(function(u){var s=n[u],a=o[u],c=e.map(function(e){return s.map(function(n,r){var o=a[r];if(!(e in n))return 0;var u=t[e],s=n[e],c=s/u,f=1/u,l=i[r].boost;return c*f*l/o}).reduce(r,0)}),f=0;return c.forEach(function(e){e>f&&(f=e)}),{id:u,score:f}});return u.sort(function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}),u}function a(e,t){return y.all(t.map(function(t){return e.get(t.id)})).then(function(e){e.forEach(function(e,n){t[n].doc=e})}).then(function(){return t})}function c(e,t,n,r,o){var u=t.highlighting_pre||"<strong>",s=t.highlighting_post||"</strong>";return y.all(n.map(function(t){return y.resolve().then(function(){return t.doc?t.doc:e.get(t.id)}).then(function(e){t.highlighting={},o[t.id].forEach(function(n,o){var a=r[o],c=a.field,f=i(a,e);Object.keys(n).forEach(function(e){var n=new RegExp("("+e+"[a-z]*)","gi"),r=u+"$1"+s;f=f.replace(n,r),t.highlighting[c]=f})})})})).then(function(){return n})}function f(e,t,n){try{return!(!t||t(e))}catch(r){return n.emit("error",r),!0}}var l="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},h=e("pouchdb-mapreduce");Object.keys(h).forEach(function(e){n[e]=h[e]});var d=e("./pouch-utils"),p=e("lunr"),v=e("uniq"),y=d.Promise,m={},g="a",w="b";n.search=d.toPromise(function(e,t){var n=this;e=d.extend(!0,{},e);var r=e.query||e.q,i="mm"in e?parseFloat(e.mm)/100:1,f=e.fields,h=e.highlighting,y=e.include_docs,b=e.destroy,k=e.stale,_=e.limit,S=e.build,x=e.skip||0,E=e.language||"en",j=e.filter;if(Array.isArray(f)){var O={};f.forEach(function(e){O[e]=1}),f=O}var A=Object.keys(f).map(function(e){var t=-1!==e.indexOf(".")&&e.split(".");return{field:e,deepField:t,boost:f[e]}}),F=m[E];F||(F=m[E]=p(),"en"!==E&&F.use(l.lunr[E]));var N={language:E,fields:A.map(function(e){return e.field}).sort()};j&&(N.filter=j.toString());var T="search-"+d.MD5(JSON.stringify(N)),P=u(A,F,j,n),I={saveAs:T};if(b)return I.destroy=!0,n._search_query(P,I,t);if(S)return delete I.stale,I.limit=0,void n._search_query(P,I).then(function(){t(null,{ok:!0})})["catch"](t);var q=v(o(r,F));return q.length?(I.keys=q.map(function(e){return g+e}),"string"==typeof k&&(I.stale=k),void n._search_query(P,I).then(function(r){if(!r.rows.length)return t(null,{rows:[]});var o={},u={};if(r.rows.forEach(function(e){var t=e.key.substring(1),n=e.value||0;if(t in u?u[t]++:u[t]=1,!(e.id in o))for(var r=o[e.id]=[],i=0;i<A.length;i++)r[i]={};var s=o[e.id][n];t in s?s[t]++:s[t]=1}),q.length>1&&Object.keys(o).forEach(function(e){var t={},n=o[e];Object.keys(n).forEach(function(e){Object.keys(n[e]).forEach(function(e){t[e]=!0})});var r=Object.keys(t).length,u=r/q.length;Math.floor(100*u)/100<i&&delete o[e]}),!Object.keys(o).length)return t(null,{rows:[]});var f=Object.keys(o).map(function(e){return w+e}),l={saveAs:T,keys:f};return n._search_query(P,l).then(function(e){var t={};e.rows.forEach(function(e){t[e.id]=e.value});var n=s(q,u,o,t,A);return n}).then(function(e){return"number"==typeof _&&_>=0?e.slice(x,x+_):x>0?e.slice(x):e}).then(function(e){return y?a(n,e):e}).then(function(t){return h?c(n,e,t,A,o):t}).then(function(e){t(null,{rows:e})})})["catch"](t)):t(null,{rows:[]})}),"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":35,lunr:23,"pouchdb-mapreduce":28,uniq:34}],2:[function(e,t){"use strict";function n(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}t.exports=n},{}],3:[function(){},{}],4:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],5:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],6:[function(e,t){"use strict";function n(){}t.exports=n},{}],7:[function(e,t){"use strict";var n=e("./promise"),r=e("./reject"),o=e("./resolve"),i=e("./INTERNAL"),u=e("./handlers"),s=r(new TypeError("must be an array"));t.exports=function(e){function t(e,t){function n(e){c[t]=e,++f===r&!a&&(a=!0,u.resolve(h,c))}o(e).then(n,function(e){a||(a=!0,u.reject(h,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return s;var r=e.length,a=!1;if(!r)return o([]);for(var c=new Array(r),f=0,l=-1,h=new n(i);++l<r;)t(e[l],l);return h}},{"./INTERNAL":6,"./handlers":8,"./promise":10,"./reject":12,"./resolve":13}],8:[function(e,t,n){"use strict";function r(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e("./tryCatch"),i=e("./resolveThenable"),u=e("./states");n.resolve=function(e,t){var s=o(r,t);if("error"===s.status)return n.reject(e,s.value);var a=s.value;if(a)i.safely(e,a);else{e.state=u.FULFILLED,e.outcome=t;for(var c=-1,f=e.queue.length;++c<f;)e.queue[c].callFulfilled(t)}return e},n.reject=function(e,t){e.state=u.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":14,"./states":15,"./tryCatch":16}],9:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all")},{"./all":7,"./promise":10,"./reject":12,"./resolve":13}],10:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if("function"!=typeof e)throw new TypeError("reslover must be a function");this.state=u.PENDING,this.queue=[],this.outcome=void 0,e!==o&&i.safely(this,e)}var r=e("./unwrap"),o=e("./INTERNAL"),i=e("./resolveThenable"),u=e("./states"),s=e("./queueItem");t.exports=n,n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===u.FULFILLED||"function"!=typeof t&&this.state===u.REJECTED)return this;var i=new n(o);if(this.state!==u.PENDING){var a=this.state===u.FULFILLED?e:t;r(i,a,this.outcome)}else this.queue.push(new s(i,e,t));return i}},{"./INTERNAL":6,"./queueItem":11,"./resolveThenable":14,"./states":15,"./unwrap":17}],11:[function(e,t){"use strict";function n(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var r=e("./handlers"),o=e("./unwrap");t.exports=n,n.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){r.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)}},{"./handlers":8,"./unwrap":17}],12:[function(e,t){"use strict";function n(e){var t=new r(o);return i.reject(t,e)}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n},{"./INTERNAL":6,"./handlers":8,"./promise":10}],13:[function(e,t){"use strict";function n(e){if(e)return e instanceof r?e:i.resolve(new r(o),e);var t=typeof e;switch(t){case"boolean":return u;case"undefined":return a;case"object":return s;case"number":return c;case"string":return f}}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n;var u=i.resolve(new r(o),!1),s=i.resolve(new r(o),null),a=i.resolve(new r(o),void 0),c=i.resolve(new r(o),0),f=i.resolve(new r(o),"")},{"./INTERNAL":6,"./handlers":8,"./promise":10}],14:[function(e,t,n){"use strict";function r(e,t){function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}function u(){t(r,n)}var s=!1,a=i(u);"error"===a.status&&n(a.value)}var o=e("./handlers"),i=e("./tryCatch");n.safely=r},{"./handlers":8,"./tryCatch":16}],15:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],16:[function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=n},{}],17:[function(e,t){"use strict";function n(e,t,n){r(function(){var r;try{r=t(n)}catch(i){return o.reject(e,i)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}var r=e("immediate"),o=e("./handlers");t.exports=n},{"./handlers":8,immediate:18}],18:[function(e,t){"use strict";function n(){o=!0;for(var e,t,n=s.length;n;){for(t=s,s=[],e=-1;++e<n;)t[e]();n=s.length}o=!1}function r(e){1!==s.push(e)||o||i()}for(var o,i,u=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],s=[],a=-1,c=u.length;++a<c;)if(u[a]&&u[a].test&&u[a].test()){i=u[a].install(n);break}t.exports=r},{"./messageChannel":19,"./mutation.js":20,"./nextTick":3,"./stateChange":21,"./timeout":22}],19:[function(e,t,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.test=function(){return r.setImmediate?!1:"undefined"!=typeof r.MessageChannel},n.install=function(e){var t=new r.MessageChannel;return t.port1.onmessage=e,function(){t.port2.postMessage(0)}}},{}],20:[function(e,t,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},o=r.MutationObserver||r.WebKitMutationObserver;n.test=function(){return o},n.install=function(e){var t=0,n=new o(e),i=r.document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}},{}],21:[function(e,t,n){var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.test=function(){return"document"in r&&"onreadystatechange"in r.document.createElement("script")},n.install=function(e){return function(){var t=r.document.createElement("script");return t.onreadystatechange=function(){e(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},r.document.documentElement.appendChild(t),e}}},{}],22:[function(e,t,n){"use strict";n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}},{}],23:[function(e,t,n){!function(){var e=function(t){var n=new e.Index;return n.pipeline.add(e.trimmer,e.stopWordFilter,e.stemmer),t&&t.call(n,n),n};e.version="0.5.5",e.utils={},e.utils.warn=function(e){return function(t){e.console&&console.warn&&console.warn(t)}}(this),e.EventEmitter=function(){this.events={}},e.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=e;if("function"!=typeof t)throw new TypeError("last argument must be a function");n.forEach(function(e){this.hasHandler(e)||(this.events[e]=[]),this.events[e].push(t)},this)},e.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var n=this.events[e].indexOf(t);this.events[e].splice(n,1),this.events[e].length||delete this.events[e]}},e.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)})}},e.EventEmitter.prototype.hasHandler=function(e){return e in this.events},e.tokenizer=function(e){if(!arguments.length||null==e||void 0==e)return[];if(Array.isArray(e))return e.map(function(e){return e.toLowerCase()});for(var t=e.toString().replace(/^\s+/,""),n=t.length-1;n>=0;n--)if(/\S/.test(t.charAt(n))){t=t.substring(0,n+1);break}return t.split(/(?:\s+|\-)/).filter(function(e){return!!e}).map(function(e){return e.toLowerCase()})},e.Pipeline=function(){this._stack=[]},e.Pipeline.registeredFunctions={},e.Pipeline.registerFunction=function(t,n){n in this.registeredFunctions&&e.utils.warn("Overwriting existing registered function: "+n),t.label=n,e.Pipeline.registeredFunctions[t.label]=t},e.Pipeline.warnIfFunctionNotRegistered=function(t){var n=t.label&&t.label in this.registeredFunctions;n||e.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",t)},e.Pipeline.load=function(t){var n=new e.Pipeline;return t.forEach(function(t){var r=e.Pipeline.registeredFunctions[t];if(!r)throw new Error("Cannot load un-registered function: "+t);n.add(r)}),n},e.Pipeline.prototype.add=function(){var t=Array.prototype.slice.call(arguments);t.forEach(function(t){e.Pipeline.warnIfFunctionNotRegistered(t),this._stack.push(t)},this)},e.Pipeline.prototype.after=function(t,n){e.Pipeline.warnIfFunctionNotRegistered(n);var r=this._stack.indexOf(t)+1;this._stack.splice(r,0,n)},e.Pipeline.prototype.before=function(t,n){e.Pipeline.warnIfFunctionNotRegistered(n);var r=this._stack.indexOf(t);this._stack.splice(r,0,n)},e.Pipeline.prototype.remove=function(e){var t=this._stack.indexOf(e);this._stack.splice(t,1)},e.Pipeline.prototype.run=function(e){for(var t=[],n=e.length,r=this._stack.length,o=0;n>o;o++){for(var i=e[o],u=0;r>u&&(i=this._stack[u](i,o,e),void 0!==i);u++);void 0!==i&&t.push(i)}return t},e.Pipeline.prototype.reset=function(){this._stack=[]},e.Pipeline.prototype.toJSON=function(){return this._stack.map(function(t){return e.Pipeline.warnIfFunctionNotRegistered(t),t.label})},e.Vector=function(){this._magnitude=null,this.list=void 0,this.length=0},e.Vector.Node=function(e,t,n){this.idx=e,this.val=t,this.next=n},e.Vector.prototype.insert=function(t,n){var r=this.list;if(!r)return this.list=new e.Vector.Node(t,n,r),this.length++;for(var o=r,i=r.next;void 0!=i;){if(t<i.idx)return o.next=new e.Vector.Node(t,n,i),this.length++;o=i,i=i.next}return o.next=new e.Vector.Node(t,n,i),this.length++},e.Vector.prototype.magnitude=function(){if(this._magniture)return this._magnitude;for(var e,t=this.list,n=0;t;)e=t.val,n+=e*e,t=t.next;return this._magnitude=Math.sqrt(n)},e.Vector.prototype.dot=function(e){for(var t=this.list,n=e.list,r=0;t&&n;)t.idx<n.idx?t=t.next:t.idx>n.idx?n=n.next:(r+=t.val*n.val,t=t.next,n=n.next);return r},e.Vector.prototype.similarity=function(e){return this.dot(e)/(this.magnitude()*e.magnitude())},e.SortedSet=function(){this.length=0,this.elements=[]},e.SortedSet.load=function(e){var t=new this;return t.elements=e,t.length=e.length,t},e.SortedSet.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(e){~this.indexOf(e)||this.elements.splice(this.locationFor(e),0,e)},this),this.length=this.elements.length},e.SortedSet.prototype.toArray=function(){return this.elements.slice()},e.SortedSet.prototype.map=function(e,t){return this.elements.map(e,t)},e.SortedSet.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},e.SortedSet.prototype.indexOf=function(e,t,n){var t=t||0,n=n||this.elements.length,r=n-t,o=t+Math.floor(r/2),i=this.elements[o];return 1>=r?i===e?o:-1:e>i?this.indexOf(e,o,n):i>e?this.indexOf(e,t,o):i===e?o:void 0},e.SortedSet.prototype.locationFor=function(e,t,n){var t=t||0,n=n||this.elements.length,r=n-t,o=t+Math.floor(r/2),i=this.elements[o];if(1>=r){if(i>e)return o;if(e>i)return o+1}return e>i?this.locationFor(e,o,n):i>e?this.locationFor(e,t,o):void 0},e.SortedSet.prototype.intersect=function(t){for(var n=new e.SortedSet,r=0,o=0,i=this.length,u=t.length,s=this.elements,a=t.elements;;){if(r>i-1||o>u-1)break;s[r]!==a[o]?s[r]<a[o]?r++:s[r]>a[o]&&o++:(n.add(s[r]),r++,o++)}return n},e.SortedSet.prototype.clone=function(){var t=new e.SortedSet;return t.elements=this.toArray(),t.length=t.elements.length,t},e.SortedSet.prototype.union=function(e){var t,n,r;return this.length>=e.length?(t=this,n=e):(t=e,n=this),r=t.clone(),r.add.apply(r,n.toArray()),r},e.SortedSet.prototype.toJSON=function(){return this.toArray()},e.Index=function(){this._fields=[],this._ref="id",this.pipeline=new e.Pipeline,this.documentStore=new e.Store,this.tokenStore=new e.TokenStore,this.corpusTokens=new e.SortedSet,this.eventEmitter=new e.EventEmitter,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},e.Index.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},e.Index.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},e.Index.load=function(t){t.version!==e.version&&e.utils.warn("version mismatch: current "+e.version+" importing "+t.version);var n=new this;return n._fields=t.fields,n._ref=t.ref,n.documentStore=e.Store.load(t.documentStore),n.tokenStore=e.TokenStore.load(t.tokenStore),n.corpusTokens=e.SortedSet.load(t.corpusTokens),n.pipeline=e.Pipeline.load(t.pipeline),n},e.Index.prototype.field=function(e,t){var t=t||{},n={name:e,boost:t.boost||1};return this._fields.push(n),this},e.Index.prototype.ref=function(e){return this._ref=e,this},e.Index.prototype.add=function(t,n){var r={},o=new e.SortedSet,i=t[this._ref],n=void 0===n?!0:n;this._fields.forEach(function(n){var i=this.pipeline.run(e.tokenizer(t[n.name]));r[n.name]=i,e.SortedSet.prototype.add.apply(o,i)},this),this.documentStore.set(i,o),e.SortedSet.prototype.add.apply(this.corpusTokens,o.toArray());for(var u=0;u<o.length;u++){var s=o.elements[u],a=this._fields.reduce(function(e,t){var n=r[t.name].length;if(!n)return e;var o=r[t.name].filter(function(e){return e===s}).length;return e+o/n*t.boost},0);this.tokenStore.add(s,{ref:i,tf:a})}n&&this.eventEmitter.emit("add",t,this)},e.Index.prototype.remove=function(e,t){var n=e[this._ref],t=void 0===t?!0:t;if(this.documentStore.has(n)){var r=this.documentStore.get(n);this.documentStore.remove(n),r.forEach(function(e){this.tokenStore.remove(e,n)},this),t&&this.eventEmitter.emit("remove",e,this)}},e.Index.prototype.update=function(e,t){var t=void 0===t?!0:t;this.remove(e,!1),this.add(e,!1),t&&this.eventEmitter.emit("update",e,this)},e.Index.prototype.idf=function(e){var t="@"+e;if(Object.prototype.hasOwnProperty.call(this._idfCache,t))return this._idfCache[t];var n=this.tokenStore.count(e),r=1;return n>0&&(r=1+Math.log(this.tokenStore.length/n)),this._idfCache[t]=r},e.Index.prototype.search=function(t){var n=this.pipeline.run(e.tokenizer(t)),r=new e.Vector,o=[],i=this._fields.reduce(function(e,t){return e+t.boost},0),u=n.some(function(e){return this.tokenStore.has(e)},this);if(!u)return[];n.forEach(function(t,n,u){var s=1/u.length*this._fields.length*i,a=this,c=this.tokenStore.expand(t).reduce(function(n,o){var i=a.corpusTokens.indexOf(o),u=a.idf(o),c=1,f=new e.SortedSet;if(o!==t){var l=Math.max(3,o.length-t.length);c=1/Math.log(l)}return i>-1&&r.insert(i,s*u*c),Object.keys(a.tokenStore.get(o)).forEach(function(e){f.add(e)}),n.union(f)},new e.SortedSet);o.push(c)},this);var s=o.reduce(function(e,t){return e.intersect(t)});return s.map(function(e){return{ref:e,score:r.similarity(this.documentVector(e))}},this).sort(function(e,t){return t.score-e.score})},e.Index.prototype.documentVector=function(t){for(var n=this.documentStore.get(t),r=n.length,o=new e.Vector,i=0;r>i;i++){var u=n.elements[i],s=this.tokenStore.get(u)[t].tf,a=this.idf(u);o.insert(this.corpusTokens.indexOf(u),s*a)}return o},e.Index.prototype.toJSON=function(){return{version:e.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},e.Index.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},e.Store=function(){this.store={},this.length=0},e.Store.load=function(t){var n=new this;return n.length=t.length,n.store=Object.keys(t.store).reduce(function(n,r){return n[r]=e.SortedSet.load(t.store[r]),n},{}),n},e.Store.prototype.set=function(e,t){this.store[e]=t,this.length=Object.keys(this.store).length},e.Store.prototype.get=function(e){return this.store[e]},e.Store.prototype.has=function(e){return e in this.store},e.Store.prototype.remove=function(e){this.has(e)&&(delete this.store[e],this.length--)},e.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},e.stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",r="[aeiouy]",o=n+"[^aeiouy]*",i=r+"[aeiou]*",u="^("+o+")?"+i+o,s="^("+o+")?"+i+o+"("+i+")?$",a="^("+o+")?"+i+o+i+o,c="^("+o+")?"+r;return function(n){var i,f,l,h,d,p,v;if(n.length<3)return n;if(l=n.substr(0,1),"y"==l&&(n=l.toUpperCase()+n.substr(1)),h=/^(.+?)(ss|i)es$/,d=/^(.+?)([^s])s$/,h.test(n)?n=n.replace(h,"$1$2"):d.test(n)&&(n=n.replace(d,"$1$2")),h=/^(.+?)eed$/,d=/^(.+?)(ed|ing)$/,h.test(n)){var y=h.exec(n);h=new RegExp(u),h.test(y[1])&&(h=/.$/,n=n.replace(h,""))}else if(d.test(n)){var y=d.exec(n);i=y[1],d=new RegExp(c),d.test(i)&&(n=i,d=/(at|bl|iz)$/,p=new RegExp("([^aeiouylsz])\\1$"),v=new RegExp("^"+o+r+"[^aeiouwxy]$"),d.test(n)?n+="e":p.test(n)?(h=/.$/,n=n.replace(h,"")):v.test(n)&&(n+="e"))}if(h=/^(.+?[^aeiou])y$/,h.test(n)){var y=h.exec(n);i=y[1],n=i+"i"}if(h=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,h.test(n)){var y=h.exec(n);i=y[1],f=y[2],h=new RegExp(u),h.test(i)&&(n=i+e[f])}if(h=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,h.test(n)){var y=h.exec(n);i=y[1],f=y[2],h=new RegExp(u),h.test(i)&&(n=i+t[f])}if(h=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,d=/^(.+?)(s|t)(ion)$/,h.test(n)){var y=h.exec(n);i=y[1],h=new RegExp(a),h.test(i)&&(n=i)}else if(d.test(n)){var y=d.exec(n);i=y[1]+y[2],d=new RegExp(a),d.test(i)&&(n=i)}if(h=/^(.+?)e$/,h.test(n)){var y=h.exec(n);i=y[1],h=new RegExp(a),d=new RegExp(s),p=new RegExp("^"+o+r+"[^aeiouwxy]$"),(h.test(i)||d.test(i)&&!p.test(i))&&(n=i)}return h=/ll$/,d=new RegExp(a),h.test(n)&&d.test(n)&&(h=/.$/,n=n.replace(h,"")),"y"==l&&(n=l.toLowerCase()+n.substr(1)),n}}(),e.Pipeline.registerFunction(e.stemmer,"stemmer"),e.stopWordFilter=function(t){return-1===e.stopWordFilter.stopWords.indexOf(t)?t:void 0},e.stopWordFilter.stopWords=new e.SortedSet,e.stopWordFilter.stopWords.length=119,e.stopWordFilter.stopWords.elements=["","a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"],e.Pipeline.registerFunction(e.stopWordFilter,"stopWordFilter"),e.trimmer=function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"")},e.Pipeline.registerFunction(e.trimmer,"trimmer"),e.TokenStore=function(){this.root={docs:{}},this.length=0},e.TokenStore.load=function(e){var t=new this;return t.root=e.root,t.length=e.length,t},e.TokenStore.prototype.add=function(e,t,n){var n=n||this.root,r=e[0],o=e.slice(1);return r in n||(n[r]={docs:{}}),0===o.length?(n[r].docs[t.ref]=t,void(this.length+=1)):this.add(o,t,n[r])},e.TokenStore.prototype.has=function(e){if(!e)return!1;for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return!1;t=t[e[n]]}return!0},e.TokenStore.prototype.getNode=function(e){if(!e)return{};for(var t=this.root,n=0;n<e.length;n++){if(!t[e[n]])return{};t=t[e[n]]}return t},e.TokenStore.prototype.get=function(e,t){return this.getNode(e,t).docs||{}},e.TokenStore.prototype.count=function(e,t){return Object.keys(this.get(e,t)).length},e.TokenStore.prototype.remove=function(e,t){if(e){for(var n=this.root,r=0;r<e.length;r++){if(!(e[r]in n))return;n=n[e[r]]}delete n.docs[t]}},e.TokenStore.prototype.expand=function(e,t){var n=this.getNode(e),r=n.docs||{},t=t||[];return Object.keys(r).length&&t.push(e),Object.keys(n).forEach(function(n){"docs"!==n&&t.concat(this.expand(e+n,t))},this),t},e.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},function(e,r){"function"==typeof define&&define.amd?define(r):"object"==typeof n?t.exports=r():e.lunr=r()}(this,function(){return e})}()},{}],24:[function(e,t,n){!function(e,r){"function"==typeof define&&define.amd?define(r):"object"==typeof n?t.exports=r():e.md5=r()}(this,function(){function e(e,t){var u=e[0],s=e[1],a=e[2],c=e[3];u=n(u,s,a,c,t[0],7,-680876936),c=n(c,u,s,a,t[1],12,-389564586),a=n(a,c,u,s,t[2],17,606105819),s=n(s,a,c,u,t[3],22,-1044525330),u=n(u,s,a,c,t[4],7,-176418897),c=n(c,u,s,a,t[5],12,1200080426),a=n(a,c,u,s,t[6],17,-1473231341),s=n(s,a,c,u,t[7],22,-45705983),u=n(u,s,a,c,t[8],7,1770035416),c=n(c,u,s,a,t[9],12,-1958414417),a=n(a,c,u,s,t[10],17,-42063),s=n(s,a,c,u,t[11],22,-1990404162),u=n(u,s,a,c,t[12],7,1804603682),c=n(c,u,s,a,t[13],12,-40341101),a=n(a,c,u,s,t[14],17,-1502002290),s=n(s,a,c,u,t[15],22,1236535329),u=r(u,s,a,c,t[1],5,-165796510),c=r(c,u,s,a,t[6],9,-1069501632),a=r(a,c,u,s,t[11],14,643717713),s=r(s,a,c,u,t[0],20,-373897302),u=r(u,s,a,c,t[5],5,-701558691),c=r(c,u,s,a,t[10],9,38016083),a=r(a,c,u,s,t[15],14,-660478335),s=r(s,a,c,u,t[4],20,-405537848),u=r(u,s,a,c,t[9],5,568446438),c=r(c,u,s,a,t[14],9,-1019803690),a=r(a,c,u,s,t[3],14,-187363961),s=r(s,a,c,u,t[8],20,1163531501),u=r(u,s,a,c,t[13],5,-1444681467),c=r(c,u,s,a,t[2],9,-51403784),a=r(a,c,u,s,t[7],14,1735328473),s=r(s,a,c,u,t[12],20,-1926607734),u=o(u,s,a,c,t[5],4,-378558),c=o(c,u,s,a,t[8],11,-2022574463),a=o(a,c,u,s,t[11],16,1839030562),s=o(s,a,c,u,t[14],23,-35309556),u=o(u,s,a,c,t[1],4,-1530992060),c=o(c,u,s,a,t[4],11,1272893353),a=o(a,c,u,s,t[7],16,-155497632),s=o(s,a,c,u,t[10],23,-1094730640),u=o(u,s,a,c,t[13],4,681279174),c=o(c,u,s,a,t[0],11,-358537222),a=o(a,c,u,s,t[3],16,-722521979),s=o(s,a,c,u,t[6],23,76029189),u=o(u,s,a,c,t[9],4,-640364487),c=o(c,u,s,a,t[12],11,-421815835),a=o(a,c,u,s,t[15],16,530742520),s=o(s,a,c,u,t[2],23,-995338651),u=i(u,s,a,c,t[0],6,-198630844),c=i(c,u,s,a,t[7],10,1126891415),a=i(a,c,u,s,t[14],15,-1416354905),s=i(s,a,c,u,t[5],21,-57434055),u=i(u,s,a,c,t[12],6,1700485571),c=i(c,u,s,a,t[3],10,-1894986606),a=i(a,c,u,s,t[10],15,-1051523),s=i(s,a,c,u,t[1],21,-2054922799),u=i(u,s,a,c,t[8],6,1873313359),c=i(c,u,s,a,t[15],10,-30611744),a=i(a,c,u,s,t[6],15,-1560198380),s=i(s,a,c,u,t[13],21,1309151649),u=i(u,s,a,c,t[4],6,-145523070),c=i(c,u,s,a,t[11],10,-1120210379),a=i(a,c,u,s,t[2],15,718787259),s=i(s,a,c,u,t[9],21,-343485551),e[0]=l(u,e[0]),e[1]=l(s,e[1]),e[2]=l(a,e[2]),e[3]=l(c,e[3])}function t(e,t,n,r,o,i){return t=l(l(t,e),l(r,i)),l(t<<o|t>>>32-o,n)}function n(e,n,r,o,i,u,s){return t(n&r|~n&o,e,n,i,u,s)}function r(e,n,r,o,i,u,s){return t(n&o|r&~o,e,n,i,u,s)}function o(e,n,r,o,i,u,s){return t(n^r^o,e,n,i,u,s)}function i(e,n,r,o,i,u,s){return t(r^(n|~o),e,n,i,u,s)}function u(t){txt="";var n,r=t.length,o=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=t.length;n+=64)e(o,s(t.substring(n-64,n)));t=t.substring(n-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)i[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(e(o,i),n=0;16>n;n++)i[n]=0;return i[14]=8*r,e(o,i),o}function s(e){var t,n=[];for(t=0;64>t;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function a(e){for(var t="",n=0;4>n;n++)t+=h[e>>8*n+4&15]+h[e>>8*n&15];return t}function c(e){for(var t=0;t<e.length;t++)e[t]=a(e[t]);return e.join("")}function f(e){return c(u(e))}function l(e,t){return e+t&4294967295}function l(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}var h="0123456789abcdef".split("");return"5d41402abc4b2a76b9719d911017c592"!=f("hello"),f})},{}],25:[function(e,t){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?s[l.call(e)]||"object":typeof e}function r(e){return null!==e&&e===e.window}function o(e){if(!e||"object"!==n(e)||e.nodeType||r(e))return!1;try{if(e.constructor&&!h.call(e,"constructor")&&!h.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var o;for(o in e);return void 0===o||h.call(e,o)}function i(e){return"function"===n(e)}function u(){var e,t,n,r,s,a,c=arguments[0]||{},f=1,l=arguments.length,h=!1;for("boolean"==typeof c&&(h=c,c=arguments[1]||{},f=2),"object"==typeof c||i(c)||(c={}),l===f&&(c=this,--f);l>f;f++)if(null!=(e=arguments[f]))for(t in e)if(!(t in Object.prototype)){if(n=c[t],r=e[t],c===r)continue;h&&r&&(o(r)||(s=d(r)))?(s?(s=!1,a=n&&d(n)?n:[]):a=n&&o(n)?n:{},c[t]=u(h,a,r)):void 0!==r&&(d(e)&&i(r)||(c[t]=r))}return c}for(var s={},a=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],c=0;c<a.length;c++){var f=a[c];s["[object "+f+"]"]=f.toLowerCase()}var l=s.toString,h=s.hasOwnProperty,d=Array.isArray||function(e){return"array"===n(e)};t.exports=u},{}],26:[function(e,t){"use strict";var n=e("./upsert"),r=e("./utils"),o=r.Promise;t.exports=function(e){var t=e.db,i=e.viewName,u=e.map,s=e.reduce,a=e.temporary,c=e.saveAs,f=u.toString()+(s&&s.toString())+"undefined"+(c||"");if(!a&&t._cachedViews){var l=t._cachedViews[f];if(l)return o.resolve(l)}return t.info().then(function(e){function l(){function e(e){e.views=e.views||{};var t=i;-1===t.indexOf("/")&&(t=i+"/"+i);var n=e.views[t]=e.views[t]||{};if(!n[d])return n[d]=!0,e}return n(t,"_local/mrviews",e)}function h(){return t.registerDependentDatabase(d).then(function(e){var n=e.db;n.auto_compaction=!0;var r={name:d,db:n,sourceDB:t,adapter:t.adapter,mapFun:u,reduceFun:s};return r.db.get("_local/lastSeq")["catch"](function(e){if("not_found"!==e.name)throw e}).then(function(e){return r.seq=e?e.seq:0,a||(t._cachedViews=t._cachedViews||{},t._cachedViews[f]=r,r.db.on("destroyed",function(){delete t._cachedViews[f]})),r})})}var d=e.db_name+"-";return d+=c?c:"mrview-"+(a?"temp":r.MD5(f)),o.resolve().then(function(){return i?l():o.resolve()}).then(h)})}},{"./upsert":32,"./utils":33}],27:[function(require,module,exports){"use strict";module.exports=function(func,emit,sum,log,isArray,toJSON){return eval("'use strict'; ("+func.replace(/;\s*$/,"")+");")}},{}],28:[function(e,t,n){"use strict";function r(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function o(e,t,n){try{return{output:t.apply(null,n)}}catch(r){return e.emit("error",r),{error:r}}}function i(e,t){var n=x(e.key,t.key);return 0!==n?n:x(e.value,t.value)}function u(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e
}function s(e){var t=new Error("builtin "+e+" function requires map values to be numbers or number arrays");return t.name="invalid_value",t.status=500,t}function a(e){for(var t=0,n=0,r=e.length;r>n;n++){var o=e[n];if("number"!=typeof o){if(!Array.isArray(o))throw s("_sum");t="number"==typeof t?[t]:t;for(var i=0,u=o.length;u>i;i++){var a=o[i];if("number"!=typeof a)throw s("_sum");"undefined"==typeof t[i]?t.push(a):t[i]+=a}}else"number"==typeof t?t+=o:t[0]+=o}return t}function c(e,t,n,r){var o=t[e];"undefined"!=typeof o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(e+"="+o))}function f(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if("undefined"!=typeof e[n]&&"undefined"!=typeof e[r]&&x(e[n],e[r])>0)throw new b("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&e.reduce!==!1){if(e.include_docs)throw new b("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new b("Multi-key fetches for reduce views must use {group: true}")}if(e.group_level){if("number"!=typeof e.group_level)throw new b('Invalid value for integer: "'+e.group_level+'"');if(e.group_level<0)throw new b('Invalid value for positive integer: "'+e.group_level+'"')}}function l(e,t,n){var o,i=[],u="GET";if(c("reduce",n,i),c("include_docs",n,i),c("limit",n,i),c("descending",n,i),c("group",n,i),c("group_level",n,i),c("skip",n,i),c("startkey",n,i,!0),c("endkey",n,i,!0),c("inclusive_end",n,i),c("key",n,i,!0),i=i.join("&"),i=""===i?"":"?"+i,"undefined"!=typeof n.keys){var s=2e3,a="keys="+encodeURIComponent(JSON.stringify(n.keys));a.length+i.length+1<=s?i+=("?"===i[0]?"&":"?")+a:(u="POST","string"==typeof t?o=JSON.stringify({keys:n.keys}):t.keys=n.keys)}if("string"==typeof t){var f=r(t);return e.request({method:u,url:"_design/"+f[0]+"/_view/"+f[1]+i,body:o})}return o=o||{},Object.keys(t).forEach(function(e){o[e]=Array.isArray(t[e])?t[e]:t[e].toString()}),e.request({method:"POST",url:"_temp_view"+i,body:o})}function h(e){return function(t){if("not_found"===t.name)return e;throw t}}function d(e,t,n){var r="_local/doc_"+e;return t.db.get(r)["catch"](h({_id:r,keys:[]})).then(function(r){return t.db.allDocs({keys:r.keys,include_docs:!0}).then(function(t){var o=t.rows.map(function(e){return e.doc}).filter(function(e){return e}),i=n[e],u={};o.forEach(function(e){u[e._id]=!0,e._deleted=!i[e._id],e._deleted||(e.value=i[e._id])});var s=Object.keys(i);return s.forEach(function(e){u[e]||o.push({_id:e,value:i[e]})}),r.keys=F.uniq(s.concat(r.keys)),o.splice(0,0,r),o})})}function p(e,t,n){var r="_local/lastSeq";return e.db.get(r)["catch"](h({_id:r,seq:0})).then(function(r){var o=Object.keys(t);return N.all(o.map(function(n){return d(n,e,t)})).then(function(t){var o=[];return t.forEach(function(e){o=o.concat(e)}),r.seq=n,o.push(r),e.db.bulkDocs({docs:o})})})}function v(e,t,n){0===n.group_level&&delete n.group_level;var r,i=n.group||n.group_level;r=q[e.reduceFun]?q[e.reduceFun]:A(e.reduceFun.toString(),null,a,k,Array.isArray,JSON.parse);var s=[],c=n.group_level;t.forEach(function(e){var t=s[s.length-1],n=i?e.key:null;return i&&Array.isArray(n)&&"number"==typeof c&&(n=n.length>c?n.slice(0,c):n),t&&0===x(t.key[0][0],n)?(t.key.push([n,e.id]),void t.value.push(e.value)):void s.push({key:[[n,e.id]],value:[e.value]})});for(var f=0,l=s.length;l>f;f++){var h=s[f],d=o(e.sourceDB,r,[h.key,h.value,!1]);h.value=d.error?null:d.output,h.key=h.key[0][0]}return{rows:u(s,n.limit,n.skip)}}function y(e){return e.request({method:"POST",url:"_view_cleanup"})}function m(e,t,n){f(n,t);var r={db:e,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return P.add(function(){return O(r).then(function(e){function t(){return e.db.destroy()}return F.fin(C(e).then(function(){return R(e,n)}),t)})}),P.finish()}function g(e,t,n){function o(e){return"ok"===n.stale||"update_after"===n.stale?("update_after"===n.stale&&C(e),R(e,n)):C(e).then(function(){return R(e,n)})}if(n.saveAs){var i={db:e,saveAs:n.saveAs,map:t.map,reduce:t.reduce};return n.destroy?O(i).then(function(e){return e.db.destroy()}):(f(n,t),O(i).then(o))}var u=t,s=r(u),a=s[0],c=s[1];return e.get("_design/"+a).then(function(t){var r=t.views&&t.views[c];if(!r||"string"!=typeof r.map){var i=new Error("ddoc "+a+" has no view named "+c);throw i.name="not_found",i.status=400,i}f(n,r);var s={db:e,viewName:u,map:r.map,reduce:r.reduce};return O(s).then(o)})}function w(e,t,n){return"http"===e.type()?l(e,t,n):"string"==typeof t||n.saveAs?g(e,t,n):m(e,t,n)}function b(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,b)}catch(t){}}var k,_=e("pouchdb-collate"),S=e("./taskqueue"),x=_.collate,E=_.toIndexableString,j=_.normalizeKey,O=e("./create-view"),A=e("./evalfunc");k="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var F=e("./utils"),N=F.Promise,T=new S,P=new S,I=50,q={_sum:function(e,t){return a(t)},_count:function(e,t){return t.length},_stats:function(e,t){function n(e){for(var t=0,n=0,r=e.length;r>n;n++){var o=e[n];t+=o*o}return t}return{sum:a(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:n(t)}}},C=F.sequentialize(T,function(e){function t(e,t){var n={id:u._id,key:j(e)};"undefined"!=typeof t&&null!==t&&(n.value=j(t)),r.push(n)}function n(t,n){return function(){return p(e,t,n)}}var r,u,s;if("function"==typeof e.mapFun&&2===e.mapFun.length){var c=e.mapFun;s=function(e){return c(e,t)}}else s=A(e.mapFun.toString(),t,a,k,Array.isArray,JSON.parse);var f=e.seq||0,l=new S;return new N(function(t,a){function c(){l.finish().then(function(){e.seq=f,t()})}function h(){function t(e){a(e)}e.sourceDB.changes({conflicts:!0,include_docs:!0,since:f,limit:I}).on("complete",function(t){var a=t.results;if(!a.length)return c();for(var d={},p=0,v=a.length;v>p;p++){var y=a[p];if("_"!==y.doc._id[0]){r=[],u=y.doc,u._deleted||o(e.sourceDB,s,[u]),r.sort(i);for(var m,g={},w=0,b=r.length;b>w;w++){var k=r[w],_=[k.key,k.id];k.key===m&&_.push(w);var S=E(_);g[S]=k,m=k.key}d[y.doc._id]=g}f=y.seq}return l.add(n(d,f)),a.length<I?c():h()}).on("error",t)}h()})}),R=F.sequentialize(T,function(e,t){function n(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return o=e.total_rows,e.rows.map(function(e){return e.doc.value})})}function r(n){n.forEach(function(e){"value"in e||(e.value=null)});var r;if(r=i?v(e,n,t):{total_rows:o,offset:u,rows:n},t.include_docs){var s=n.map(function(t){var n=t.value,r=n&&"object"==typeof n&&n._id||t.id;return e.sourceDB.get(r).then(function(e){t.doc=e},function(){})});return N.all(s).then(function(){return r})}return r}var o,i=e.reduceFun&&t.reduce!==!1,u=t.skip||0;"undefined"==typeof t.keys||t.keys.length||(t.limit=0,delete t.keys);var s=function(e){return e.reduce(function(e,t){return e.concat(t)})};if("undefined"!=typeof t.keys){var a=t.keys,c=a.map(function(e){var t={startkey:E([e]),endkey:E([e,{}])};return n(t)});return N.all(c).then(s).then(r)}var f={descending:t.descending};if("undefined"!=typeof t.startkey&&(f.startkey=E(t.descending?[t.startkey,{}]:[t.startkey])),"undefined"!=typeof t.endkey){var l=t.inclusive_end!==!1;t.descending&&(l=!l),f.endkey=E(l?[t.endkey,{}]:[t.endkey])}if("undefined"!=typeof t.key){var h=E([t.key]),d=E([t.key,{}]);f.descending?(f.endkey=h,f.startkey=d):(f.startkey=h,f.endkey=d)}return i||("number"==typeof t.limit&&(f.limit=t.limit),f.skip=u),n(f).then(r)}),D=F.sequentialize(T,function(e){return e.get("_local/mrviews").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=r(e),o="_design/"+t[0],i=t[1];n[o]=n[o]||{},n[o][i]=!0});var o={keys:Object.keys(n),include_docs:!0};return e.allDocs(o).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var i=r+"/"+n;t.views[i]||(i=n);var u=Object.keys(t.views[i]),s=e.doc&&e.doc.views&&e.doc.views[n];u.forEach(function(e){o[e]=o[e]||s})})});var i=Object.keys(o).filter(function(e){return!o[e]}),u=i.map(function(t){return e.constructor.destroy(t,{adapter:e.adapter})});return N.all(u).then(function(){return{ok:!0}})})},h({ok:!0}))});n._search_viewCleanup=F.callbackify(function(){var e=this;return"http"===e.type()?y(e):D(e)}),n._search_query=function(e,t,n){"function"==typeof t&&(n=t,t={}),t=F.extend(!0,{},t),"function"==typeof e&&(e={map:e}),e.saveAs&&(t.saveAs=e.saveAs,delete e.saveAs);var r=this,o=N.resolve().then(function(){return w(r,e,t)});return F.promisedCallback(o,n),o},F.inherits(b,Error)},{"./create-view":26,"./evalfunc":27,"./taskqueue":31,"./utils":33,"pouchdb-collate":29}],29:[function(e,t,n){"use strict";function r(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return a(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),r=t?e:Object.keys(e),o=-1,i=r.length,u="";if(t)for(;++o<i;)u+=n.toIndexableString(r[o]);else for(;++o<i;){var s=r[o];u+=n.toIndexableString(s)+n.toIndexableString(e[s])}return u}return""}function o(e,t){for(var r=Math.min(e.length,t.length),o=0;r>o;o++){var i=n.collate(e[o],t[o]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function i(e,t){return e===t?0:e>t?1:-1}function u(e,t){for(var r=Object.keys(e),o=Object.keys(t),i=Math.min(r.length,o.length),u=0;i>u;u++){var s=n.collate(r[u],o[u]);if(0!==s)return s;if(s=n.collate(e[r[u]],t[o[u]]),0!==s)return s}return r.length===o.length?0:r.length>o.length?1:-1}function s(e){var t=["boolean","number","string","object"],n=t.indexOf(typeof e);return~n?null===e?1:Array.isArray(e)?5:3>n?n+2:n+3:Array.isArray(e)?5:void 0}function a(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=0>e,o=r?"0":"2",i=(r?-n:n)-c,u=h.padLeft(i.toString(),"0",f);o+=l+u;var s=Math.abs(parseFloat(t[0]));r&&(s=10-s);var a=s.toFixed(20);return a=a.replace(/\.?0+$/,""),o+=l+a}var c=-324,f=3,l="",h=e("./utils");n.collate=function(e,t){if(e===t)return 0;e=n.normalizeKey(e),t=n.normalizeKey(t);var r=s(e),a=s(t);if(r-a!==0)return r-a;if(null===e)return 0;switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:t>e?-1:1;case"string":return i(e,t)}return Array.isArray(e)?o(e,t):u(e,t)},n.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return 1/0===e||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var o=0;r>o;o++)e[o]=n.normalizeKey(t[o])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var i in t)if(t.hasOwnProperty(i)){var u=t[i];"undefined"!=typeof u&&(e[i]=n.normalizeKey(u))}}}}return e},n.toIndexableString=function(e){var t="\x00";return e=n.normalizeKey(e),s(e)+l+r(e)+t}},{"./utils":30}],30:[function(e,t,n){"use strict";function r(e,t,n){for(var r="",o=n-e.length;r.length<o;)r+=t;return r}n.padLeft=function(e,t,n){var o=r(e,t,n);return o+e},n.padRight=function(e,t,n){var o=r(e,t,n);return e+o},n.stringLexCompare=function(e,t){var n,r=e.length,o=t.length;for(n=0;r>n;n++){if(n===o)return 1;var i=e.charAt(n),u=t.charAt(n);if(i!==u)return u>i?-1:1}return o>r?-1:0},n.intToDecimalForm=function(e){var t=0>e,n="";do{var r=t?-Math.ceil(e%10):Math.floor(e%10);n=r+n,e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);return t&&"0"!==n&&(n="-"+n),n}},{}],31:[function(e,t){"use strict";function n(){this.promise=new r(function(e){e()})}var r=e("./utils").Promise;n.prototype.add=function(e){return this.promise=this.promise["catch"](function(){}).then(function(){return e()}),this.promise},n.prototype.finish=function(){return this.promise},t.exports=n},{"./utils":33}],32:[function(e,t){"use strict";function n(e,t,n){return new o(function(o,i){return t&&"object"==typeof t&&(t=t._id),"string"!=typeof t?i(new Error("doc id is required")):void e.get(t,function(u,s){if(u)return"not_found"!==u.name?i(u):o(r(e,n({_id:t}),n));var a=n(s);return a?void o(r(e,a,n)):o(s)})})}function r(e,t,r){return e.put(t)["catch"](function(o){if("conflict"!==o.name)throw o;return n(e,t,r)})}var o=e("./utils").Promise;t.exports=n},{"./utils":33}],33:[function(e,t,n){var r=e("__browserify_process"),o="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};n.Promise="function"==typeof o.Promise?o.Promise:e("lie"),n.uniq=function(e){var t={};return e.forEach(function(e){t[e]=!0}),Object.keys(t)},n.inherits=e("inherits"),n.extend=e("pouchdb-extend");var i=e("argsarray");n.promisedCallback=function(e,t){return t&&e.then(function(e){r.nextTick(function(){t(null,e)})},function(e){r.nextTick(function(){t(e)})}),e},n.callbackify=function(e){return i(function(t){var r=t.pop(),o=e.apply(this,t);return"function"==typeof r&&n.promisedCallback(o,r),o})},n.fin=function(e,t){return e.then(function(e){var n=t();return"function"==typeof n.then?n.then(function(){return e}):e},function(e){var n=t();if("function"==typeof n.then)return n.then(function(){throw e});throw e})},n.sequentialize=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}};var u=e("crypto"),s=e("md5-jkmyers");n.MD5=function(e){return r.browser?s(e):u.createHash("md5").update(e).digest("hex")}},{__browserify_process:4,argsarray:2,crypto:3,inherits:5,lie:9,"md5-jkmyers":24,"pouchdb-extend":25}],34:[function(e,t){"use strict";function n(e,t){for(var n=1,r=e.length,o=e[0],i=e[0],u=1;r>u;++u)if(i=o,o=e[u],t(o,i)){if(u===n){n++;continue}e[n++]=o}return e.length=n,e}function r(e){for(var t=1,n=e.length,r=e[0],o=e[0],i=1;n>i;++i,o=r)if(o=r,r=e[i],r!==o){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}function o(e,t,o){return 0===e.length?e:t?(o||e.sort(t),n(e,t)):(o||e.sort(),r(e))}t.exports=o},{}],35:[function(e,t,n){var r,o=e("__browserify_process"),i="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};r="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof i.Promise?i.Promise:e("lie"),n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(t){var i,u=this,s="function"==typeof t[t.length-1]?t.pop():!1;s&&(i=function(e,t){o.nextTick(function(){s(e,t)})});var a=new r(function(r,o){try{var i=n.once(function(e,t){e?o(e):r(t)});t.push(i),e.apply(u,t)}catch(s){o(s)}});return i&&a.then(function(e){i(null,e)},i),a.cancel=function(){return this},a})},n.inherits=e("inherits"),n.Promise=r;var u=e("crypto"),s=e("md5-jkmyers");n.MD5=function(e){return o.browser?s(e):u.createHash("md5").update(e).digest("hex")},n.extend=e("pouchdb-extend")},{__browserify_process:4,crypto:3,inherits:5,lie:9,"md5-jkmyers":24,"pouchdb-extend":25}]},{},[1]);